@model IList<AltivaWebApp.DomainsConta.AsientosAnalitico>
@inject IStringLocalizer<SharedResources> lb
@inject Microsoft.AspNetCore.Antiforgery.IAntiforgery Xsrf
@functions{
    public string GetAntiXsrfRequestToken()
    {
        return Xsrf.GetAndStoreTokens(Context).RequestToken;
    }
 

}
@{ 
    double totalDebe = 0;
    double totalHaber = 0;
    double saldoA = Convert.ToDouble(ViewBag.saldoanterior);
    double saldoP = Convert.ToDouble(ViewBag.saldoperiodo);
    double saldoAcum = Convert.ToDouble(ViewBag.saldoacumulado);
}
<div class="col-lg-12 col-x12">
    <h3>
        <a href="#" style="font-size:2rem;" onclick="mostrarBuscador()"><i class="fas fa-arrow-left"></i></a>
        @lb["Cuenta"]:@Model.First().CuentaContable | @lb["Nombre"]:@Model.First().Descripcion
    </h3>
</div>
<div class="col-lg-12">
    <table class="table table-bordered" id="tblAnalitico">
        <thead>
            <tr>
                <th>
                    @lb["Asiento"]
                </th>
                <th>
                    @lb["Fecha"]
                </th>
                <th>
                    @lb["Tipo"]
                </th>
                <th>
                    @lb["Documento"]
                </th>
                <th>
                    @lb["Nota"]
                </th>
                <th>
                    @lb["Debe"]
                </th>
                <th>
                    @lb["Haber"]
                </th>
            </tr>
        </thead>
        <tbody>
            @{

                foreach (AltivaWebApp.DomainsConta.AsientosAnalitico item in Model)
                {
            <tr>
                <td><a class="link" href="#" onclick="editarItem(@item.IdAsientoContable)">@item.Asiento</a></td>
                <td>@item.Fecha.ToString("dd/MM/yyyy")</td>
                <td>@item.TipoDocumento</td>
                <td>@item.NumDocumento</td>
                <td>@item.Nota</td>
                @{
                    double monto = 0;
                    if (ViewBag.IdMonedaSeleccionada == 1) { monto = item.MontoColones; }
                    if (ViewBag.IdMonedaSeleccionada == 2) { monto = item.MontoDolares; }
                    if (ViewBag.IdMonedaSeleccionada == 3) { monto = item.MontoEuro; }

                    double montoDebe = 0; double montoHaber = 0;
                    if (item.Debe)
                    {

                        montoDebe = monto;
                        totalDebe += monto;
                    }
                    if (item.Haber)
                    {
                        montoHaber = monto;
                        totalHaber += monto;
                    }

                }

                <td style="text-align:right">@montoDebe.ToString("#,##0.00")</td>
                <td style="text-align:right">@montoHaber.ToString("#,##0.00")</td>
            </tr>
                }
            <tr>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td style="text-align:right; font-weight:bold;">@lb["Totales"]:</td>
                <td style="text-align:right; font-weight:bold;">@totalDebe.ToString("#,##0.00")</td>
                <td style="text-align:right; font-weight:bold;">@totalHaber.ToString("#,##0.00")</td>
            </tr>

            }
            <tr>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td style="text-align:right"></td>
                <td style="text-align:right; font-weight:bold;">@lb["SaldoAnterior"]:</td>
                <td style="text-align:right">@saldoA.ToString("#,##0.00")</td>

            </tr>
            <tr>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td style="text-align:right"></td>
                <td style="text-align:right; font-weight:bold;">@lb["SaldoPeriodo"]:</td>
                <td style="text-align:right">@saldoP.ToString("#,##0.00")</td>

            </tr>
            <tr>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td style="text-align:right"></td>
                <td style="text-align:right; font-weight:bold;">@lb["SaldoAcumulado"]:</td>
                <td style="text-align:right">@saldoAcum.ToString("#,##0.00")</td>

            </tr>
        </tbody>    

    </table>           
    
      

</div>
<script>
    $(document).ready(function () {
        initTabla();
    });
    function initTabla() {

        $('#tblAnalitico').DataTable().destroy();

        tbl = $('#tblAnalitico').DataTable({
            "paging": false,
            "info": false,
             "bSort": false,
            dom: 'Bfrtip',
            language: {
                "decimal": ".",
                "emptyTable": "@lb["NoDatos"]",
                "info": "Mostrando _START_ a _END_ de _TOTAL_ Entradas",
                "infoEmpty": "Mostrando 0 to 0 of 0 Entradas",
                "infoFiltered": "(Filtrado de _MAX_ total entradas)",
                "infoPostFix": "",             
                "thousands": ",",
                "lengthMenu": "@lb["Mostrar"] _MENU_ @lb["Entradas"]",
                "loadingRecords": "Cargando...",
                "processing": "Procesando...",
                "search": "<i class='fas fa-search'></i>",
                "zeroRecords": "@lb["sinResultados"]",
                "paginate": {
                    "first": "@lb["Primero"]",
                    "last": "@lb["Último"]",
                    "next": "@lb["Sguiente"]",
                    "previous": "@lb["Anterior"]"
                }
            },

            buttons: [
                    {
                        extend: 'excelHtml5',
                        title: "@lb["Analitico"]",
                        text:'Excel'
                        //Columns to export
                        //exportOptions: {
                       //     columns: [0, 1, 2, 3,4,5,6]
                       // }
                    }
            ]
        });
         $(".dataTables_searching").hide();
    }
    var EsAnalitico = true;
        function editarItem(id) {

        var url = '@Url.Action("Item", "ContaAsiento", new { id = "__id__" })';
         url = url.replace("__id__", id);
         $.ajax({
             type: "Post",
             url: url,
             success: function (data) {
                 $('#itemAsiento').html(data);
                 mostrarAsiento();
             },
             error: function (err, scnd) {
                 console.log(err.statusText);
             }

         });


    }
    </script>